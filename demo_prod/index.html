<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Skop API Demo</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/global.css">
  <link rel="icon" type="image/x-icon" href="./favicon.ico">

</head>

<body>

<header>

  <img id="img-header" src="img/demo_prod.png">
</header>
<a  id="wemed" href="https://en.wemed.fr/">
  <img src="img/logoWEMED.png" alt="wemed">
</a>

<main>

  <button class="button" onclick="sessionAsPatient()" >Patient</button>
  <button class="button" onclick="sessionAsDoctor()">Médecin</button>


</main>




</body>
<script>
  //empty local storage
  localStorage.clear();

  let room = 45 // rooms are used to do one-to-one conversations, the room is the id of the conversation
  //TODO : récupérer les données de session depuis l'API si la clé d'API WEMED est valide
  var apiKey
  var sessionId
  var token

  fetch("https://test-wemed.herokuapp.com/room/" + room)
          .then(data => data.json())
          .then(data => {
            apiKey = data.apiKey
            sessionId = data.sessionId
            token = data.token
            //set the variables in local storage
            localStorage.setItem("apiKey", apiKey)
            localStorage.setItem("sessionId", sessionId)
            localStorage.setItem("token", token)
            localStorage.setItem("room", room)
          })



  function sessionAsPatient(){
    localStorage.setItem("role", "patient");
    window.location.href = "patient.html";
  }

  function sessionAsDoctor(){
    localStorage.setItem("role", "doctor");
    window.location.href = "doctor.html";
  }

</script>

</html>
